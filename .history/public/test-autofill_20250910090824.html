<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è‡ªåŠ¨å¡«å†™åŠŸèƒ½æµ‹è¯•</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }
      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
        color: #333;
      }
      input,
      select,
      textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
      }
      textarea {
        height: 80px;
        resize: vertical;
      }
      .btn {
        background: #007bff;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 10px 5px;
      }
      .btn:hover {
        background: #0056b3;
      }
      .btn-success {
        background: #28a745;
      }
      .btn-success:hover {
        background: #1e7e34;
      }
      .result {
        margin-top: 20px;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
      }
      .success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .form-row {
        display: flex;
        gap: 15px;
      }
      .form-row .form-group {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš€ è‡ªåŠ¨å¡«å†™åŠŸèƒ½æµ‹è¯•</h1>

      <div class="test-section">
        <h3>æµ‹è¯•æ§åˆ¶</h3>
        <button class="btn btn-success" onclick="testAutofill()">
          ğŸ¯ æµ‹è¯•è‡ªåŠ¨å¡«å†™
        </button>
        <button class="btn" onclick="clearForm()">ğŸ§¹ æ¸…ç©ºè¡¨å•</button>
        <div id="test-result"></div>
      </div>

      <div class="test-section">
        <h3>æµ‹è¯•è¡¨å•</h3>
        <form id="test-form">
          <div class="form-row">
            <div class="form-group">
              <label for="firstName">å§“å</label>
              <input
                type="text"
                id="firstName"
                name="firstName"
                placeholder="è¯·è¾“å…¥å§“å"
              />
            </div>
            <div class="form-group">
              <label for="phone">æ‰‹æœºå·ç </label>
              <input
                type="tel"
                id="phone"
                name="phone"
                placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç "
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="email">é‚®ç®±åœ°å€</label>
              <input
                type="email"
                id="email"
                name="email"
                placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€"
              />
            </div>
            <div class="form-group">
              <label for="location">æ‰€åœ¨åŸå¸‚</label>
              <input
                type="text"
                id="location"
                name="location"
                placeholder="è¯·è¾“å…¥æ‰€åœ¨åŸå¸‚"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="wechat">å¾®ä¿¡å·</label>
              <input
                type="text"
                id="wechat"
                name="wechat"
                placeholder="è¯·è¾“å…¥å¾®ä¿¡å·"
              />
            </div>
            <div class="form-group">
              <label for="github">GitHub</label>
              <input
                type="text"
                id="github"
                name="github"
                placeholder="è¯·è¾“å…¥GitHubåœ°å€"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="university">æ¯•ä¸šé™¢æ ¡</label>
              <input
                type="text"
                id="university"
                name="university"
                placeholder="è¯·è¾“å…¥æ¯•ä¸šé™¢æ ¡"
              />
            </div>
            <div class="form-group">
              <label for="major">ä¸“ä¸š</label>
              <input
                type="text"
                id="major"
                name="major"
                placeholder="è¯·è¾“å…¥ä¸“ä¸š"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="graduationTime">æ¯•ä¸šæ—¶é—´</label>
              <input
                type="text"
                id="graduationTime"
                name="graduationTime"
                placeholder="è¯·è¾“å…¥æ¯•ä¸šæ—¶é—´"
              />
            </div>
            <div class="form-group">
              <label for="gpa">GPA</label>
              <input type="text" id="gpa" name="gpa" placeholder="è¯·è¾“å…¥GPA" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="experience">å·¥ä½œç»éªŒ</label>
              <select id="experience" name="experience">
                <option value="">è¯·é€‰æ‹©å·¥ä½œç»éªŒ</option>
                <option value="0-1">0-1å¹´</option>
                <option value="1-3">1-3å¹´</option>
                <option value="3-5">3-5å¹´</option>
                <option value="5-10">5-10å¹´</option>
                <option value="10+">10å¹´ä»¥ä¸Š</option>
              </select>
            </div>
            <div class="form-group">
              <label for="education">å­¦å†æ°´å¹³</label>
              <select id="education" name="education">
                <option value="">è¯·é€‰æ‹©å­¦å†</option>
                <option value="é«˜ä¸­">é«˜ä¸­</option>
                <option value="å¤§ä¸“">å¤§ä¸“</option>
                <option value="æœ¬ç§‘">æœ¬ç§‘</option>
                <option value="ç¡•å£«">ç¡•å£«</option>
                <option value="åšå£«">åšå£«</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="salary">æœŸæœ›è–ªèµ„</label>
            <select id="salary" name="salary">
              <option value="">è¯·é€‰æ‹©æœŸæœ›è–ªèµ„</option>
              <option value="5k-8k">5K-8K</option>
              <option value="8k-12k">8K-12K</option>
              <option value="12k-18k">12K-18K</option>
              <option value="18k-25k">18K-25K</option>
              <option value="25k+">25Kä»¥ä¸Š</option>
              <option value="100w">100w</option>
            </select>
          </div>

          <div class="form-group">
            <label for="skills">ä¸“ä¸šæŠ€èƒ½</label>
            <textarea
              id="skills"
              name="skills"
              placeholder="è¯·æè¿°æ‚¨çš„ä¸“ä¸šæŠ€èƒ½"
            ></textarea>
          </div>

          <div class="form-group">
            <label for="introduction">ä¸ªäººç®€ä»‹</label>
            <textarea
              id="introduction"
              name="introduction"
              placeholder="è¯·ç®€è¦ä»‹ç»æ‚¨çš„å·¥ä½œç»å†å’Œä¸ªäººä¼˜åŠ¿"
            ></textarea>
          </div>
        </form>
      </div>
    </div>

    <script>
      // é»˜è®¤ç”¨æˆ·æ•°æ®
      const defaultProfileData = {
        firstName: "å®",
        lastName: "çŸ¿åŠ›",
        name: "å®çŸ¿åŠ›",
        email: "baokuangli@outlook.com",
        phone: "13344556677",
        phoneNumber: "13344556677",
        wechat: "bkl",
        wechatId: "bkl",
        location: "æµ™æ±Ÿæ­å·",
        city: "æµ™æ±Ÿæ­å·",
        github: "baokuangli@outlook.com",
        githubUrl: "baokuangli@outlook.com",
        university: "æµ™æ±Ÿå¤§å­¦",
        school: "æµ™æ±Ÿå¤§å­¦",
        major: "æ‘†çƒ‚",
        specialty: "æ‘†çƒ‚",
        graduationTime: "2024å¹´6æœˆ",
        graduationDate: "2024å¹´6æœˆ",
        gpa: "5.0",
        salary: "100w",
        expectedSalary: "100w",
        introduction: "æˆ‘æ˜¯å®çŸ¿åŠ›",
        resumeText: "æˆ‘æ˜¯å®çŸ¿åŠ›",
        summary: "æˆ‘æ˜¯å®çŸ¿åŠ›",
      };

      // å­—æ®µæ˜ å°„é…ç½®ï¼ˆæ¨¡æ‹Ÿcontent.jsä¸­çš„é€»è¾‘ï¼‰
      const fieldMappings = {
        mock: {
          name: 'input[name="firstName"], input[id="firstName"], input[name="name"], input[id="name"], input[placeholder*="å§“å"]',
          firstName:
            'input[name="firstName"], input[id="firstName"], input[placeholder*="å§“å"]',
          lastName:
            'input[name="lastName"], input[id="lastName"], input[placeholder*="å§“æ°"]',
          phone:
            'input[name="phone"], input[id="phone"], input[type="tel"], input[placeholder*="æ‰‹æœº"]',
          email:
            'input[name="email"], input[id="email"], input[type="email"], input[placeholder*="é‚®ç®±"]',
          experience: 'select[name="experience"], select[id="experience"]',
          education: 'select[name="education"], select[id="education"]',
          salary: 'select[name="salary"], select[id="salary"]',
          location:
            'input[name="location"], input[id="location"], input[placeholder*="åŸå¸‚"]',
          skills:
            'textarea[name="skills"], textarea[id="skills"], textarea[placeholder*="æŠ€èƒ½"]',
          resume:
            'textarea[name="introduction"], textarea[id="introduction"], textarea[name="resume"], textarea[id="resume"], textarea[placeholder*="ç®€å†"], textarea[placeholder*="ä¸ªäººç®€ä»‹"]',
          introduction:
            'textarea[name="introduction"], textarea[id="introduction"], textarea[placeholder*="ä¸ªäººç®€ä»‹"]',
          wechat:
            'input[name="wechat"], input[id="wechat"], input[placeholder*="å¾®ä¿¡"]',
          github:
            'input[name="github"], input[id="github"], input[placeholder*="GitHub"]',
          university:
            'input[name="university"], input[id="university"], input[placeholder*="é™¢æ ¡"]',
          major:
            'input[name="major"], input[id="major"], input[placeholder*="ä¸“ä¸š"]',
          graduationTime:
            'input[name="graduationTime"], input[id="graduationTime"], input[placeholder*="æ¯•ä¸šæ—¶é—´"]',
          gpa: 'input[name="gpa"], input[id="gpa"], input[placeholder*="GPA"]',
        },
      };

      // è·å–å­—æ®µå€¼ï¼ˆæ¨¡æ‹Ÿcontent.jsä¸­çš„getFieldValueæ–¹æ³•ï¼‰
      function getFieldValue(fieldType, profileData) {
        const mapping = {
          name:
            profileData.name || profileData.fullName || profileData.firstName,
          firstName: profileData.firstName || profileData.name,
          lastName: profileData.lastName || profileData.surname,
          phone:
            profileData.phone || profileData.mobile || profileData.phoneNumber,
          email: profileData.email,
          experience: profileData.workExperience || profileData.experience,
          education: profileData.education || profileData.degree,
          salary: profileData.salary || profileData.expectedSalary,
          location: profileData.location || profileData.city,
          skills: profileData.skills || profileData.specialties,
          resume:
            profileData.resumeText ||
            profileData.summary ||
            profileData.introduction,
          introduction:
            profileData.introduction ||
            profileData.resumeText ||
            profileData.summary,
          wechat: profileData.wechat || profileData.wechatId,
          github: profileData.github || profileData.githubUrl,
          university: profileData.university || profileData.school,
          major: profileData.major || profileData.specialty,
          graduationTime:
            profileData.graduationTime || profileData.graduationDate,
          gpa: profileData.gpa,
        };

        return mapping[fieldType] || "";
      }

      // å¡«å†™å­—æ®µï¼ˆæ¨¡æ‹Ÿcontent.jsä¸­çš„fillFieldæ–¹æ³•ï¼‰
      function fillField(element, value) {
        if (!element || !value) return false;

        try {
          if (element.tagName === "SELECT") {
            // å¤„ç†ä¸‹æ‹‰é€‰æ‹©æ¡†
            const options = Array.from(element.options);
            const matchedOption = options.find(
              (option) =>
                option.value === value ||
                option.textContent.includes(value) ||
                value.includes(option.value)
            );

            if (matchedOption) {
              element.value = matchedOption.value;
              element.dispatchEvent(new Event("change", { bubbles: true }));
              return true;
            }
          } else if (
            element.tagName === "INPUT" ||
            element.tagName === "TEXTAREA"
          ) {
            // å¤„ç†è¾“å…¥æ¡†å’Œæ–‡æœ¬åŸŸ
            element.value = value;
            element.dispatchEvent(new Event("input", { bubbles: true }));
            element.dispatchEvent(new Event("change", { bubbles: true }));
            return true;
          }
        } catch (error) {
          console.error("å¡«å†™å­—æ®µæ—¶å‡ºé”™:", error);
        }

        return false;
      }

      // æµ‹è¯•è‡ªåŠ¨å¡«å†™åŠŸèƒ½
      function testAutofill() {
        const resultDiv = document.getElementById("test-result");
        resultDiv.innerHTML =
          '<div style="padding: 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; margin-top: 10px;">ğŸ”„ æ­£åœ¨æµ‹è¯•è‡ªåŠ¨å¡«å†™...</div>';

        let totalFields = 0;
        let filledFields = 0;
        const results = [];

        // éå†æ‰€æœ‰å­—æ®µæ˜ å°„
        for (const [fieldType, selector] of Object.entries(
          fieldMappings.mock
        )) {
          const elements = document.querySelectorAll(selector);
          const value = getFieldValue(fieldType, defaultProfileData);

          if (elements.length > 0 && value) {
            totalFields++;
            const element = elements[0]; // ä½¿ç”¨ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ 
            const success = fillField(element, value);

            if (success) {
              filledFields++;
              results.push(`âœ… ${fieldType}: "${value}"`);
              // æ·»åŠ è§†è§‰æ•ˆæœ
              element.style.backgroundColor = "#d4edda";
              setTimeout(() => {
                element.style.backgroundColor = "";
              }, 2000);
            } else {
              results.push(`âŒ ${fieldType}: å¡«å†™å¤±è´¥`);
            }
          } else if (value) {
            results.push(`âš ï¸ ${fieldType}: æœªæ‰¾åˆ°å¯¹åº”å­—æ®µ (${selector})`);
          }
        }

        // æ˜¾ç¤ºç»“æœ
        setTimeout(() => {
          const success = filledFields > 0;
          const resultClass = success ? "success" : "error";
          const resultIcon = success ? "ğŸ‰" : "âŒ";

          resultDiv.innerHTML = `
                    <div class="result ${resultClass}">
                        <h4>${resultIcon} æµ‹è¯•ç»“æœ</h4>
                        <p><strong>æˆåŠŸå¡«å†™:</strong> ${filledFields}/${totalFields} ä¸ªå­—æ®µ</p>
                        <details>
                            <summary>è¯¦ç»†ç»“æœ</summary>
                            <pre>${results.join("\n")}</pre>
                        </details>
                    </div>
                `;

          console.log("è‡ªåŠ¨å¡«å†™æµ‹è¯•å®Œæˆ:", {
            totalFields,
            filledFields,
            success: filledFields > 0,
            results,
          });
        }, 500);
      }

      // æ¸…ç©ºè¡¨å•
      function clearForm() {
        const form = document.getElementById("test-form");
        form.reset();

        // æ¸…ç©ºç»“æœæ˜¾ç¤º
        const resultDiv = document.getElementById("test-result");
        resultDiv.innerHTML =
          '<div style="padding: 10px; background: #e2e3e5; border: 1px solid #d6d8db; border-radius: 4px; margin-top: 10px;">âœ¨ è¡¨å•å·²æ¸…ç©º</div>';

        setTimeout(() => {
          resultDiv.innerHTML = "";
        }, 2000);
      }

      // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
      window.addEventListener("load", function () {
        console.log("æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ");
        console.log("é»˜è®¤æ•°æ®:", defaultProfileData);
      });
    </script>
  </body>
</html>
