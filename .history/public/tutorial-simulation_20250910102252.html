<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç®€å†åŠ©æ‰‹ - æ•™å­¦æ¼”ç¤ºä¸å²—ä½æ¨¡æ‹Ÿ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 700;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .content {
        padding: 30px;
      }

      /* æ•™å­¦è¯´æ˜åŒºåŸŸæ ·å¼ */
      .tutorial-section {
        margin-bottom: 40px;
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 20px;
        color: #2c3e50;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .steps-container,
      .tips-container {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        border-left: 4px solid #667eea;
      }

      .step-item,
      .tip-item {
        margin-bottom: 15px;
        padding: 10px;
        background: white;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }

      .step-number {
        display: inline-block;
        width: 24px;
        height: 24px;
        background: #667eea;
        color: white;
        border-radius: 50%;
        text-align: center;
        line-height: 24px;
        font-size: 12px;
        font-weight: bold;
        margin-right: 10px;
      }

      /* çŠ¶æ€æŒ‡ç¤ºå™¨æ ·å¼ */
      .status-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .status-indicator {
        padding: 15px;
        border-radius: 8px;
        border: 2px solid #ddd;
        background: #f5f5f5;
        text-align: center;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .profile-summary {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .completion-bar {
        background: #e9ecef;
        border-radius: 10px;
        height: 20px;
        margin: 10px 0;
        overflow: hidden;
      }

      .completion-fill {
        background: linear-gradient(90deg, #52c41a, #73d13d);
        height: 100%;
        border-radius: 10px;
        transition: width 0.3s ease;
        width: 0%;
      }

      /* å²—ä½ä¿¡æ¯æ ·å¼ */
      .job-info {
        background: linear-gradient(135deg, #1890ff 0%, #096dd9 100%);
        color: white;
        padding: 25px;
        border-radius: 8px;
        margin-bottom: 30px;
      }

      .job-title {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .job-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .job-detail-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 10px 15px;
        border-radius: 6px;
        backdrop-filter: blur(10px);
      }

      /* è¡¨å•æ ·å¼ */
      .form-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 30px;
        margin-top: 20px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #2c3e50;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e1e8ed;
        border-radius: 6px;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      textarea {
        resize: vertical;
        min-height: 100px;
      }

      .demo-button {
        background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin-bottom: 20px;
        width: 100%;
        transition: all 0.3s ease;
      }

      .demo-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(82, 196, 26, 0.3);
      }

      .submit-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 15px 40px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      }

      .success-message {
        display: none;
        background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);
        color: white;
        padding: 30px;
        border-radius: 8px;
        text-align: center;
        margin-top: 20px;
      }

      .success-message h3 {
        font-size: 1.5rem;
        margin-bottom: 10px;
      }

      /* åŠ¨ç”»æ•ˆæœ */
      .highlight-field {
        animation: highlightPulse 1s ease-in-out;
      }

      @keyframes highlightPulse {
        0% {
          background-color: #fff;
        }
        50% {
          background-color: #f6ffed;
          border-color: #52c41a;
        }
        100% {
          background-color: #f6ffed;
          border-color: #52c41a;
        }
      }

      .loading {
        opacity: 0.7;
        pointer-events: none;
      }

      @media (max-width: 768px) {
        .form-row {
          grid-template-columns: 1fr;
        }

        .status-section {
          grid-template-columns: 1fr;
        }

        .job-details {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸš€ ç®€å†åŠ©æ‰‹æ•™å­¦æ¼”ç¤º</h1>
        <p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨ç®€å†åŠ©æ‰‹æ’ä»¶ï¼Œå¹¶ä½“éªŒçœŸå®çš„å²—ä½ç”³è¯·æµç¨‹</p>
      </div>

      <div class="content">
        <!-- æ•™å­¦è¯´æ˜åŒºåŸŸ -->
        <div class="tutorial-section">
          <h2 class="section-title">ğŸ“‹ ä½¿ç”¨æ­¥éª¤</h2>
          <div class="steps-container">
            <div class="step-item">
              <span class="step-number">1</span>
              <strong>å®‰è£…æ’ä»¶ï¼š</strong>ç¡®ä¿å·²å®‰è£…ç®€å†åŠ©æ‰‹æµè§ˆå™¨æ’ä»¶
            </div>
            <div class="step-item">
              <span class="step-number">2</span>
              <strong>æ£€æŸ¥è¿æ¥ï¼š</strong
              >æŸ¥çœ‹ä¸‹æ–¹æ’ä»¶çŠ¶æ€æŒ‡ç¤ºå™¨ï¼Œç¡®è®¤æ’ä»¶å·²æ­£å¸¸è¿æ¥
            </div>
            <div class="step-item">
              <span class="step-number">3</span>
              <strong>æŸ¥çœ‹æ¡£æ¡ˆï¼š</strong
              >å¦‚æœå·²æœ‰æ¡£æ¡ˆæ•°æ®ï¼Œä¼šåœ¨ä¸‹æ–¹æ˜¾ç¤ºæ¡£æ¡ˆæ‘˜è¦å’Œå®Œæˆåº¦
            </div>
            <div class="step-item">
              <span class="step-number">4</span>
              <strong>ä½“éªŒå¡«å†™ï¼š</strong
              >ç‚¹å‡»"å¼€å§‹è‡ªåŠ¨å¡«å†™æ¼”ç¤º"æŒ‰é’®ï¼Œä½“éªŒä¸€é”®å¡«å†™åŠŸèƒ½
            </div>
            <div class="step-item">
              <span class="step-number">5</span>
              <strong>æäº¤ç”³è¯·ï¼š</strong>å¡«å†™å®Œæˆåï¼Œç‚¹å‡»æäº¤æŒ‰é’®å®Œæˆå²—ä½ç”³è¯·
            </div>
          </div>

          <h2 class="section-title">ğŸ’¡ ä½¿ç”¨æç¤º</h2>
          <div class="tips-container">
            <div class="tip-item">
              <strong>ğŸ”Œ æ’ä»¶çŠ¶æ€ï¼š</strong
              >å¦‚æœæ’ä»¶çŠ¶æ€æ˜¾ç¤ºæœªè¿æ¥ï¼Œè¯·åˆ·æ–°é¡µé¢æˆ–é‡æ–°å®‰è£…æ’ä»¶
            </div>
            <div class="tip-item">
              <strong>ğŸ“Š æ¡£æ¡ˆå®Œæˆåº¦ï¼š</strong
              >å®Œæˆåº¦è¶Šé«˜ï¼Œè‡ªåŠ¨å¡«å†™çš„ä¿¡æ¯è¶Šå®Œæ•´å’Œå‡†ç¡®
            </div>
            <div class="tip-item">
              <strong>ğŸ¯ æ¼”ç¤ºæ¨¡å¼ï¼š</strong
              >å¦‚æœæ²¡æœ‰æ¡£æ¡ˆæ•°æ®ï¼Œç³»ç»Ÿä¼šä½¿ç”¨æ¼”ç¤ºæ•°æ®è¿›è¡Œå¡«å†™å±•ç¤º
            </div>
            <div class="tip-item">
              <strong>âœ¨ å­—æ®µé«˜äº®ï¼š</strong>è‡ªåŠ¨å¡«å†™æ—¶ï¼Œè¢«å¡«å……çš„å­—æ®µä¼šæœ‰é«˜äº®æ•ˆæœ
            </div>
          </div>

          <!-- çŠ¶æ€æŒ‡ç¤ºå™¨åŒºåŸŸ -->
          <div class="status-section">
            <div id="statusIndicator" class="status-indicator">
              ğŸ” æ­£åœ¨æ£€æµ‹æ’ä»¶çŠ¶æ€...
            </div>
            <div id="extension-status" class="status-indicator">
              ğŸ” æ­£åœ¨æ£€æµ‹æ‰©å±•...
            </div>
          </div>

          <!-- æ¡£æ¡ˆæ‘˜è¦åŒºåŸŸ -->
          <div
            id="profileSummary"
            class="profile-summary"
            style="display: none"
          >
            <h3>ğŸ“‹ æ¡£æ¡ˆä¿¡æ¯æ‘˜è¦</h3>
            <div id="profileContent"></div>
            <div class="completion-bar">
              <div id="completionFill" class="completion-fill"></div>
            </div>
            <p id="completionText">æ¡£æ¡ˆå®Œæˆåº¦: 0%</p>
          </div>
        </div>

        <!-- å²—ä½ä¿¡æ¯åŒºåŸŸ -->
        <div class="job-info">
          <div class="job-title">ğŸ¢ è…¾è®¯ç§‘æŠ€ - å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ</div>
          <p>ğŸ“ æ·±åœ³å¸‚å—å±±åŒº | ğŸ’° 15k-30k | ğŸ“… å…¨èŒ | ğŸ“ æœ¬ç§‘åŠä»¥ä¸Š</p>
          <div class="job-details">
            <div class="job-detail-item">
              <strong>æŠ€èƒ½è¦æ±‚ï¼š</strong>JavaScript, React, Vue, Node.js
            </div>
            <div class="job-detail-item">
              <strong>å·¥ä½œç»éªŒï¼š</strong>1-3å¹´ç›¸å…³ç»éªŒ
            </div>
            <div class="job-detail-item">
              <strong>å­¦å†è¦æ±‚ï¼š</strong>æœ¬ç§‘åŠä»¥ä¸Šå­¦å†
            </div>
            <div class="job-detail-item">
              <strong>å·¥ä½œåœ°ç‚¹ï¼š</strong>æ·±åœ³å¸‚å—å±±åŒºç§‘æŠ€å›­
            </div>
          </div>
        </div>

        <!-- è¡¨å•åŒºåŸŸ -->
        <div class="form-section">
          <button
            id="demo-button"
            class="demo-button"
            onclick="startFormFillingDemo()"
          >
            ğŸ¯ å¼€å§‹è‡ªåŠ¨å¡«å†™æ¼”ç¤º
          </button>

          <form id="job-application-form">
            <h3 style="margin-bottom: 20px; color: #2c3e50">ğŸ“ å²—ä½ç”³è¯·è¡¨</h3>

            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ‘¤ åŸºæœ¬ä¿¡æ¯</h4>
              <div class="form-row">
                <div>
                  <label for="name">å§“å *</label>
                  <input type="text" id="name" name="name" required />
                </div>
                <div>
                  <label for="email">é‚®ç®± *</label>
                  <input type="email" id="email" name="email" required />
                </div>
              </div>
              <div class="form-row">
                <div>
                  <label for="phone">æ‰‹æœºå· *</label>
                  <input type="tel" id="phone" name="phone" required />
                </div>
                <div>
                  <label for="age">å¹´é¾„</label>
                  <input type="number" id="age" name="age" min="18" max="65" />
                </div>
              </div>
            </div>

            <!-- æ•™è‚²èƒŒæ™¯ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ“ æ•™è‚²èƒŒæ™¯</h4>
              <div class="form-row">
                <div>
                  <label for="education">å­¦å† *</label>
                  <select id="education" name="education" required>
                    <option value="">è¯·é€‰æ‹©å­¦å†</option>
                    <option value="é«˜ä¸­">é«˜ä¸­</option>
                    <option value="å¤§ä¸“">å¤§ä¸“</option>
                    <option value="æœ¬ç§‘">æœ¬ç§‘</option>
                    <option value="ç¡•å£«">ç¡•å£«</option>
                    <option value="åšå£«">åšå£«</option>
                  </select>
                </div>
                <div>
                  <label for="graduationYear">æ¯•ä¸šå¹´ä»½</label>
                  <input
                    type="number"
                    id="graduationYear"
                    name="graduationYear"
                    min="1990"
                    max="2030"
                  />
                </div>
              </div>
              <div class="form-row">
                <div>
                  <label for="school">æ¯•ä¸šé™¢æ ¡</label>
                  <input type="text" id="school" name="school" />
                </div>
                <div>
                  <label for="major">ä¸“ä¸š</label>
                  <input type="text" id="major" name="major" />
                </div>
              </div>
            </div>

            <!-- å·¥ä½œç»éªŒ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ’¼ å·¥ä½œç»éªŒ</h4>
              <div class="form-row">
                <div>
                  <label for="experience">å·¥ä½œå¹´é™</label>
                  <select id="experience" name="experience">
                    <option value="">è¯·é€‰æ‹©å·¥ä½œå¹´é™</option>
                    <option value="åº”å±Šæ¯•ä¸šç”Ÿ">åº”å±Šæ¯•ä¸šç”Ÿ</option>
                    <option value="1å¹´ä»¥ä¸‹">1å¹´ä»¥ä¸‹</option>
                    <option value="1-3å¹´">1-3å¹´</option>
                    <option value="3-5å¹´">3-5å¹´</option>
                    <option value="5-10å¹´">5-10å¹´</option>
                    <option value="10å¹´ä»¥ä¸Š">10å¹´ä»¥ä¸Š</option>
                  </select>
                </div>
                <div>
                  <label for="currentCompany">å½“å‰/æœ€è¿‘å…¬å¸</label>
                  <input
                    type="text"
                    id="currentCompany"
                    name="currentCompany"
                  />
                </div>
              </div>
            </div>

            <!-- é¡¹ç›®ç»éªŒ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸš€ é¡¹ç›®ç»éªŒ</h4>
              <div>
                <label for="projectExperience">ä¸»è¦é¡¹ç›®ç»éªŒ</label>
                <textarea
                  id="projectExperience"
                  name="projectExperience"
                  placeholder="è¯·æè¿°æ‚¨çš„ä¸»è¦é¡¹ç›®ç»éªŒï¼ŒåŒ…æ‹¬é¡¹ç›®åç§°ã€æŠ€æœ¯æ ˆã€æ‚¨çš„èŒè´£ç­‰..."
                ></textarea>
              </div>
            </div>

            <!-- æŠ€èƒ½æ ‡ç­¾ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ› ï¸ æŠ€èƒ½æ ‡ç­¾</h4>
              <div>
                <label for="skills">æŠ€èƒ½å…³é”®è¯</label>
                <input
                  type="text"
                  id="skills"
                  name="skills"
                  placeholder="å¦‚ï¼šJavaScript, React, Vue, Node.js, Python ç­‰"
                />
              </div>
            </div>

            <!-- æ±‚èŒæ„å‘ -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ¯ æ±‚èŒæ„å‘</h4>
              <div class="form-row">
                <div>
                  <label for="targetPosition">æœŸæœ›èŒä½</label>
                  <input
                    type="text"
                    id="targetPosition"
                    name="targetPosition"
                  />
                </div>
                <div>
                  <label for="targetSalary">æœŸæœ›è–ªèµ„</label>
                  <input
                    type="text"
                    id="targetSalary"
                    name="targetSalary"
                    placeholder="å¦‚ï¼š10k-15k"
                  />
                </div>
              </div>
              <div>
                <label for="targetCity">æœŸæœ›å·¥ä½œåŸå¸‚</label>
                <input type="text" id="targetCity" name="targetCity" />
              </div>
            </div>

            <!-- è‡ªæˆ‘ä»‹ç» -->
            <div class="form-group">
              <h4 style="margin-bottom: 15px; color: #667eea">ğŸ“ è‡ªæˆ‘ä»‹ç»</h4>
              <div>
                <label for="selfIntroduction">è‡ªæˆ‘ä»‹ç»</label>
                <textarea
                  id="selfIntroduction"
                  name="selfIntroduction"
                  placeholder="è¯·ç®€è¦ä»‹ç»æ‚¨çš„ä¸ªäººèƒŒæ™¯ã€æŠ€èƒ½ç‰¹é•¿ã€èŒä¸šè§„åˆ’ç­‰..."
                ></textarea>
              </div>
            </div>

            <button type="submit" class="submit-btn">ğŸš€ æäº¤ç”³è¯·</button>
          </form>

          <!-- æˆåŠŸæ¶ˆæ¯ -->
          <div id="success-message" class="success-message">
            <h3>ğŸ‰ ç”³è¯·æäº¤æˆåŠŸï¼</h3>
            <p>æ„Ÿè°¢æ‚¨çš„ç”³è¯·ï¼Œæˆ‘ä»¬ä¼šåœ¨3ä¸ªå·¥ä½œæ—¥å†…ä¸æ‚¨è”ç³»ã€‚</p>
            <p>è¯·ä¿æŒæ‰‹æœºç•…é€šï¼Œæ³¨æ„æŸ¥æ”¶é‚®ä»¶ã€‚</p>
          </div>
        </div>
      </div>
    </div>

    <!-- å¼•å…¥è„šæœ¬ -->
    <!-- <script src="js/extension-handshake.js"></script> -->
    <!-- <script src="js/state-manager.js"></script> -->
    <!-- <script src="js/auth.js"></script> -->

    <script>
      // å…¨å±€å˜é‡
      let extensionDetected = false;
      let profileData = null;
      let tutorialManager = null;

      // TutorialManager ç±»
      class TutorialManager {
        constructor() {
          this.profileData = null;
          this.completionPercentage = 0;
          this.init();
        }

        async init() {
          console.log("åˆå§‹åŒ–æ•™ç¨‹ç®¡ç†å™¨");
          await this.checkPluginStatus();
          await this.loadProfileData();
          this.updateUI();
        }

        async checkPluginStatus() {
          const statusIndicator = document.getElementById("statusIndicator");

          try {
            // æ¨¡æ‹Ÿæ’ä»¶æ£€æµ‹
            statusIndicator.textContent = "ğŸ” æ­£åœ¨æ£€æµ‹æ’ä»¶...";
            statusIndicator.style.background = "#ffa940";
            statusIndicator.style.borderColor = "#fa8c16";

            await new Promise((resolve) => setTimeout(resolve, 1000));

            // æ£€æŸ¥æ˜¯å¦æœ‰ sj_profile æ•°æ®
            if (localStorage.getItem("sj_profile")) {
              statusIndicator.textContent = "âœ… æ’ä»¶å·²è¿æ¥";
              statusIndicator.style.background = "#52c41a";
              statusIndicator.style.borderColor = "#389e0d";
            } else {
              statusIndicator.textContent = "âš ï¸ æ’ä»¶æœªæ£€æµ‹åˆ°æ¡£æ¡ˆæ•°æ®";
              statusIndicator.style.background = "#faad14";
              statusIndicator.style.borderColor = "#d48806";
            }
          } catch (error) {
            console.error("æ’ä»¶æ£€æµ‹å¤±è´¥:", error);
            statusIndicator.textContent = "âŒ æ’ä»¶æ£€æµ‹å¤±è´¥";
            statusIndicator.style.background = "#ff4d4f";
            statusIndicator.style.borderColor = "#cf1322";
          }
        }

        async loadProfileData() {
          try {
            const profileJson = localStorage.getItem("sj_profile");
            if (profileJson) {
              this.profileData = JSON.parse(profileJson);
              console.log("åŠ è½½æ¡£æ¡ˆæ•°æ®:", this.profileData);
              this.calculateCompletion();
            } else {
              console.log("æœªæ‰¾åˆ°æ¡£æ¡ˆæ•°æ®");
            }
          } catch (error) {
            console.error("åŠ è½½æ¡£æ¡ˆæ•°æ®å¤±è´¥:", error);
          }
        }

        calculateCompletion() {
          if (!this.profileData) {
            this.completionPercentage = 0;
            return;
          }

          const fields = [
            "name",
            "email",
            "phone",
            "education",
            "school",
            "major",
            "experience",
            "skills",
            "targetPosition",
            "targetSalary",
          ];

          let completedFields = 0;
          fields.forEach((field) => {
            if (
              this.profileData[field] &&
              this.profileData[field].toString().trim()
            ) {
              completedFields++;
            }
          });

          this.completionPercentage = Math.round(
            (completedFields / fields.length) * 100
          );
        }

        updateUI() {
          const profileSummary = document.getElementById("profileSummary");
          const profileContent = document.getElementById("profileContent");
          const completionFill = document.getElementById("completionFill");
          const completionText = document.getElementById("completionText");

          if (this.profileData) {
            profileSummary.style.display = "block";

            // æ›´æ–°æ¡£æ¡ˆæ‘˜è¦å†…å®¹
            profileContent.innerHTML = `
                        <p><strong>å§“å:</strong> ${
                          this.profileData.name || "æœªå¡«å†™"
                        }</p>
                        <p><strong>é‚®ç®±:</strong> ${
                          this.profileData.email || "æœªå¡«å†™"
                        }</p>
                        <p><strong>å­¦å†:</strong> ${
                          this.profileData.education || "æœªå¡«å†™"
                        }</p>
                        <p><strong>æœŸæœ›èŒä½:</strong> ${
                          this.profileData.targetPosition || "æœªå¡«å†™"
                        }</p>
                    `;

            // æ›´æ–°å®Œæˆåº¦
            completionFill.style.width = this.completionPercentage + "%";
            completionText.textContent = `æ¡£æ¡ˆå®Œæˆåº¦: ${this.completionPercentage}%`;
          } else {
            profileSummary.style.display = "none";
          }
        }

        fillFormWithProfile() {
          if (!this.profileData) {
            console.log("æ²¡æœ‰æ¡£æ¡ˆæ•°æ®ï¼Œä½¿ç”¨æ¼”ç¤ºæ•°æ®");
            return false;
          }

          console.log("ä½¿ç”¨æ¡£æ¡ˆæ•°æ®å¡«å……è¡¨å•");

          const fieldMapping = {
            name: "name",
            email: "email",
            phone: "phone",
            education: "education",
            school: "school",
            major: "major",
            experience: "experience",
            skills: "skills",
            targetPosition: "targetPosition",
            targetSalary: "targetSalary",
            targetCity: "targetCity",
          };

          Object.keys(fieldMapping).forEach((formField) => {
            const profileField = fieldMapping[formField];
            const element = document.getElementById(formField);

            if (element && this.profileData[profileField]) {
              element.value = this.profileData[profileField];
              this.highlightField(element);
            }
          });

          return true;
        }

        highlightField(element) {
          element.classList.add("highlight-field");
          setTimeout(() => {
            element.classList.remove("highlight-field");
          }, 1000);
        }

        clearDemoForm() {
          const form = document.getElementById("job-application-form");
          const inputs = form.querySelectorAll("input, select, textarea");

          inputs.forEach((input) => {
            input.value = "";
            input.style.background = "";
            input.style.borderColor = "";
          });
        }

        async recheckPlugin() {
          await this.checkPluginStatus();
          await this.loadProfileData();
          this.updateUI();
        }

        performDemoFilling() {
          console.log("æ‰§è¡Œæ¼”ç¤ºå¡«å†™");

          const demoData = {
            name: "å¼ ä¸‰",
            email: "zhangsan@example.com",
            phone: "13800138000",
            education: "æœ¬ç§‘",
            graduationYear: "2022",
            school: "æ¸…åå¤§å­¦",
            major: "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯",
            experience: "1-3å¹´",
            currentCompany: "é˜¿é‡Œå·´å·´",
            targetPosition: "å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
            targetSalary: "15k-20k",
            targetCity: "æ·±åœ³",
            skills: "JavaScript, React, Vue, Node.js",
            projectExperience:
              "è´Ÿè´£å¼€å‘å¤šä¸ªå¤§å‹å‰ç«¯é¡¹ç›®ï¼ŒåŒ…æ‹¬ç”µå•†å¹³å°ã€ç®¡ç†ç³»ç»Ÿç­‰ï¼Œç†Ÿç»ƒä½¿ç”¨Reactå’ŒVueæ¡†æ¶ã€‚",
            selfIntroduction:
              "æˆ‘æ˜¯ä¸€åçƒ­çˆ±å‰ç«¯å¼€å‘çš„å·¥ç¨‹å¸ˆï¼Œå…·æœ‰3å¹´çš„å¼€å‘ç»éªŒï¼Œç†Ÿç»ƒæŒæ¡ç°ä»£å‰ç«¯æŠ€æœ¯æ ˆã€‚",
          };

          Object.keys(demoData).forEach((key) => {
            const field = document.getElementById(key);
            if (field) {
              setTimeout(() => {
                field.value = demoData[key];
                this.highlightField(field);
              }, Math.random() * 2000);
            }
          });
        }
      }

      // æ‰©å±•æ£€æµ‹ç›¸å…³å‡½æ•°
      async function detectExtension() {
        try {
          const handshakeData = {
            type: "SJ_DETECT_V1",
            source: "jiancareer-tutorial",
            timestamp: Date.now(),
            data: {
              page: "tutorial-simulation",
              version: "1.0.0",
              capabilities: ["form-filling", "demo-interaction"],
            },
          };

          console.log("å‘é€æ‰©å±•æ£€æµ‹ä¿¡å·:", handshakeData);
          window.postMessage(handshakeData, "*");

          setTimeout(() => {
            if (!extensionDetected) {
              updateExtensionStatus("error", "æœªæ£€æµ‹åˆ°æ‰©å±•");
              console.log("æ‰©å±•æ£€æµ‹è¶…æ—¶");
            }
          }, 5000);
        } catch (error) {
          console.error("æ‰©å±•æ£€æµ‹å¤±è´¥:", error);
          updateExtensionStatus("error", "æ£€æµ‹å¤±è´¥");
        }
      }

      function updateExtensionStatus(status, message) {
        const indicator = document.getElementById("extension-status");
        if (!indicator) return;

        switch (status) {
          case "connected":
            indicator.style.background = "#52c41a";
            indicator.style.borderColor = "#389e0d";
            indicator.textContent = "âœ… " + message;
            break;
          case "error":
            indicator.style.background = "#ff4d4f";
            indicator.style.borderColor = "#cf1322";
            indicator.textContent = "âŒ " + message;
            break;
          case "ready":
            indicator.style.background = "#1890ff";
            indicator.style.borderColor = "#096dd9";
            indicator.textContent = "ğŸš€ " + message;
            break;
        }
      }

      function handleExtensionMessage(event) {
        const { data } = event;

        if (!data || typeof data !== "object") return;

        console.log("æ”¶åˆ°æ¶ˆæ¯:", data);

        switch (data.type) {
          case "SJ_ACK_V1":
            extensionDetected = true;
            updateExtensionStatus("connected", "æ‰©å±•å·²è¿æ¥");
            setTimeout(() => {
              updateExtensionStatus("ready", "å‡†å¤‡æ¼”ç¤º");
            }, 1000);
            break;
          case "SJ_DEMO_REQUEST":
            if (data.action === "start-demo") {
              startFormFillingDemo();
            }
            break;
          case "JC_AUTOFILL":
            console.log("æ”¶åˆ°æ’ä»¶ä¸€é”®å¡«å…¥æ¶ˆæ¯ï¼Œè§¦å‘æ¼”ç¤ºå¡«å†™åŠŸèƒ½");
            console.log("æ¶ˆæ¯æ•°æ®:", data);
            updateExtensionStatus("ready", "æ’ä»¶ä¸€é”®å¡«å…¥ä¸­...");
            startFormFillingDemo();
            break;
        }
      }

      // å¼€å§‹è¡¨å•å¡«å†™æ¼”ç¤º
      function startFormFillingDemo() {
        console.log("å¼€å§‹è¡¨å•å¡«å†™æ¼”ç¤º");

        updateExtensionStatus("ready", "æ¼”ç¤ºè¿›è¡Œä¸­...");

        // é¦–å…ˆå°è¯•ä½¿ç”¨æ¡£æ¡ˆæ•°æ®
        if (tutorialManager && tutorialManager.fillFormWithProfile()) {
          console.log("ä½¿ç”¨æ¡£æ¡ˆæ•°æ®å¡«å……è¡¨å•");
          updateExtensionStatus("ready", "æ¡£æ¡ˆæ•°æ®å¡«å……å®Œæˆ");
        } else {
          console.log("ä½¿ç”¨æ¼”ç¤ºæ•°æ®å¡«å……è¡¨å•");
          tutorialManager.performDemoFilling();
          updateExtensionStatus("ready", "æ¼”ç¤ºæ•°æ®å¡«å……å®Œæˆ");
        }

        // å‘æ‰©å±•å‘é€æ¼”ç¤ºä¿¡å·
        const demoMessage = {
          type: "SJ_START_DEMO",
          source: "jiancareer-tutorial",
          timestamp: Date.now(),
          data: {
            action: "autofill-form",
            formId: "job-application-form",
          },
        };

        window.postMessage(demoMessage, "*");
      }

      // å…¨å±€å‡½æ•°
      function checkPluginStatus() {
        if (tutorialManager) {
          tutorialManager.recheckPlugin();
        }
      }

      function loadProfileData() {
        if (tutorialManager) {
          tutorialManager.loadProfileData();
          tutorialManager.updateUI();
        }
      }

      function clearDemoForm() {
        if (tutorialManager) {
          tutorialManager.clearDemoForm();
        }
      }

      // Chromeæ‰©å±•æ¶ˆæ¯ç›‘å¬å™¨
      function handleChromeExtensionMessage(request, sender, sendResponse) {
        console.log("æ”¶åˆ°Chromeæ‰©å±•æ¶ˆæ¯:", request);
        console.log("å‘é€è€…ä¿¡æ¯:", sender);

        if (request.type === "JC_AUTOFILL") {
          console.log("æ”¶åˆ°æ’ä»¶ä¸€é”®å¡«å…¥æ¶ˆæ¯ï¼Œè§¦å‘æ¼”ç¤ºå¡«å†™åŠŸèƒ½");
          console.log("æ¶ˆæ¯æ•°æ®:", request);
          updateExtensionStatus("ready", "æ’ä»¶ä¸€é”®å¡«å…¥ä¸­...");

          // è§¦å‘æ¼”ç¤ºå¡«å†™åŠŸèƒ½
          startFormFillingDemo();

          // å‘é€å“åº”ç»™æ‰©å±•
          sendResponse({
            ok: true,
            filledCount: 15,
            totalCount: 15,
            detail: "æ¼”ç¤ºå¡«å†™å®Œæˆ",
          });

          return true; // ä¿æŒæ¶ˆæ¯é€šé“å¼€æ”¾
        }

        return false;
      }

      // é¡µé¢åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        console.log("é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–");

        // åˆå§‹åŒ–æ•™ç¨‹ç®¡ç†å™¨
        tutorialManager = new TutorialManager();

        // ç›‘å¬æ‰©å±•æ¶ˆæ¯ï¼ˆwindow.postMessageï¼‰
        window.addEventListener("message", handleExtensionMessage);

        // ç›‘å¬Chromeæ‰©å±•æ¶ˆæ¯ï¼ˆchrome.runtime.onMessageï¼‰
        if (
          typeof chrome !== "undefined" &&
          chrome.runtime &&
          chrome.runtime.onMessage
        ) {
          console.log("æ³¨å†ŒChromeæ‰©å±•æ¶ˆæ¯ç›‘å¬å™¨");
          chrome.runtime.onMessage.addListener(handleChromeExtensionMessage);
        } else {
          console.log("Chromeæ‰©å±•APIä¸å¯ç”¨ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼");
        }

        // å¼€å§‹æ‰©å±•æ£€æµ‹
        detectExtension();

        // è¡¨å•æäº¤å¤„ç†
        document
          .getElementById("job-application-form")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            document.getElementById("success-message").style.display = "block";

            // æ»šåŠ¨åˆ°æˆåŠŸæ¶ˆæ¯
            document
              .getElementById("success-message")
              .scrollIntoView({ behavior: "smooth" });

            // 3ç§’åéšè—è¡¨å•
            setTimeout(() => {
              document.getElementById("job-application-form").style.display =
                "none";
            }, 3000);
          });
      });
    </script>
  </body>
</html>
